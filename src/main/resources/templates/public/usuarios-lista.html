<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org">

<head>
    <title>ICS | Listar</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>

<body id="content">
    <script>
        const token = localStorage.getItem('token'); // Obtém o token

        fetch('/usuarios/auth/listar', {
            method: 'GET',
            headers: {
                'Authorization': `Bearer ${token}`,
                'Content-Type': 'application/json'
            }
        })
            .then(response => {
                if(token){
                    if (!response.ok) {
                        throw new Error('Network response was not ok ' + response.statusText);
                    }
                    return response.text(); // Processa a resposta como texto
                } else {
                    window.location.href = "/usuarios/entrar";
                }
            })
            .then(data => {
                document.getElementById('content').innerHTML = data; // Atualiza o conteúdo do div
            })
            .catch(error => {
                console.error('Erro ao carregar a página:', error);
                // Redireciona se houver um erro, por exemplo, se o token não for válido
                window.location.href = "/usuarios/entrar";
            });

    </script>

</body>

</html>